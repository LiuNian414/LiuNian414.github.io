<!DOCTYPE html>
<html>
<head>
    <title>逆水寒帮战BI系统</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <style>
        /* 完整样式表 */
        :root { --primary: #2c3e50; --secondary: #3498db; }
        body { font-family: 'Segoe UI', sans-serif; max-width: 1280px; margin: 0 auto; }
        .container { display: grid; grid-template-columns: 300px 1fr; gap: 20px; }
        .input-section { background: #f8f9fa; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .input-row { margin: 12px 0; display: grid; grid-template-columns: 100px 1fr; align-items: center; }
        input, select { padding: 8px; border: 1px solid #ddd; border-radius: 4px; }
        button { background: var(--secondary); color: white; padding: 12px 24px; border: none; border-radius: 4px; cursor: pointer; }
        .charts { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 30px; }
        .chart-container { height: 500px; border: 1px solid #eee; border-radius: 8px; padding: 15px; }
    </style>
</head>
<body>
    <h1>逆水寒帮战专业分析系统</h1>
    
    <div class="container">
        <!-- 数据输入区 -->
        <div class="input-section">
            <div class="input-row">
                <label>玩家名称</label>
                <input type="text" id="playerName" required>
            </div>
            <div class="input-row">
                <label>职业</label>
                <select id="playerClass" onchange="toggleSpecialFields()">
                    <option value="素问">素问</option>
                    <option value="铁衣">铁衣</option>
                    <option value="碎梦">碎梦</option>
                    <!-- 其他职业选项 -->
                </select>
            </div>
            <!-- 更多输入字段 -->
            <div class="input-row">
                <label>击败数</label>
                <input type="number" id="kills" min="0" required>
            </div>
            <div class="input-row special-field" data-class="素问">
                <label>治疗值</label>
                <input type="number" id="heal" min="0">
            </div>
            <button onclick="analyze()">分析数据</button>
        </div>

        <!-- 可视化展示区 -->
        <div class="charts">
            <div id="radarChart" class="chart-container"></div>
            <div id="teamCompare" class="chart-container"></div>
        </div>
    </div>

    <script>
        // 数据存储结构
        let battleData = {
            players: [],
            teams: {},
            classStats: {}
        };

        // 职业专用公式库
        const classFormulas = {
            '素问': (player, globalStats) => {
                const team = globalStats.teams[player.team];
                return (
                    (((player.heal + player.damageTaken/1.1 + 
                      (player.revive / team.totalDeaths * 2000)) /
                     (team.avgHeal * 2)) * 0.4 +
                    (player.heal / 2000) * 0.25 +
                    (player.resources / 260) * 0.02 +
                    (13 - player.deaths) * 0.01 +
                    (player.revive - 15) * 0.01) * 0.95
                );
            },
            '铁衣': (player, globalStats) => {
                const team = globalStats.teams[player.team];
                return (
                    ((((player.kills + player.assists*0.35 + 
                       (player.playerDamage*1.2 + player.buildingDamage*5)/100) /
                      team.avgDamage) * 10 +
                     (player.damageTaken / team.totalDamageTaken) * 2) * 0.6 +
                    (player.damageTaken / 5000) * 0.35 +
                    (player.resources / 260) * 0.03 +
                    (10 - player.deaths) * 0.015) * 1
                );
            },
            // 其他职业公式...
        };

        // 核心分析逻辑
        function analyze() {
            const player = collectInputData();
            const globalStats = calculateGlobalStats();
            
            player.score = classFormulas[player.class](player, globalStats);
            
            updateDataStore(player);
            updateVisualizations();
        }

        // 数据收集函数
        function collectInputData() {
            return {
                name: document.getElementById('playerName').value,
                class: document.getElementById('playerClass').value,
                kills: parseInt(document.getElementById('kills').value),
                // 收集其他字段...
                team: document.getElementById('team').value,
                classFactor: parseFloat(document.getElementById('classFactor').value)
            };
        }

        // 全局统计计算
        function calculateGlobalStats() {
            return {
                teams: calculateTeamStats(),
                classStats: calculateClassStats()
            };
        }

        // 可视化更新
        function updateVisualizations() {
            renderRadarChart();
            renderTeamComparison();
        }

        // GitHub Pages部署准备
        function saveData() {
            localStorage.setItem('battleData', JSON.stringify(battleData));
        }
    </script>
</body>
</html>
