<!DOCTYPE html>
<html>
<head>
    <title>é€†æ°´å¯’å¸®æˆ˜BIç³»ç»Ÿ</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <style>
        /* å®Œæ•´æ ·å¼è¡¨ */
        :root { --primary: #2c3e50; --secondary: #3498db; }
        body { font-family: 'Segoe UI', sans-serif; max-width: 1280px; margin: 0 auto; }
        .container { display: grid; grid-template-columns: 300px 1fr; gap: 20px; }
        .input-section { background: #f8f9fa; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .input-row { margin: 12px 0; display: grid; grid-template-columns: 100px 1fr; align-items: center; }
        input, select { padding: 8px; border: 1px solid #ddd; border-radius: 4px; }
        button { background: var(--secondary); color: white; padding: 12px 24px; border: none; border-radius: 4px; cursor: pointer; }
        .charts { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 30px; }
        .chart-container { height: 500px; border: 1px solid #eee; border-radius: 8px; padding: 15px; }
         /* æ–°å¢è¡¨æ ¼æ ·å¼ */
         .data-section {
             background: white;
             padding: 20px;
             border-radius: 8px;
             box-shadow: 0 2px 4px rgba(0,0,0,0.1);
             margin: 20px;
         }
         #battleTable {
             width: 100%;
             border-collapse: collapse;
             margin-top: 15px;
         }
         #battleTable th, #battleTable td {
             padding: 12px;
             border: 1px solid #eee;
             text-align: left;
         }
         #battleTable th[contenteditable] {
             background: #f8f9fa;
             min-width: 120px;
         }
    </style>
</head>
    <h1>é€†æ°´å¯’å¸®æˆ˜åˆ†æç³»ç»Ÿ</h1>
    <div class="container">
        <!-- å·¦ä¾§æ–°å¢é€‰æ‹©æ¡† -->
        <div class="input-section">
            <!-- æ–°å¢æ—¥æœŸå’Œå¯¹å±€åç§°è¾“å…¥ -->
            <div class="input-row">
                <label>æˆ˜æ–—æ—¥æœŸ</label>
                <input type="date" id="battleDate" required>
            </div>
            <div class="input-row">
                <label>å¯¹å±€åç§°</label>
                <input type="text" id="battleName" required>
            </div>

    <!-- åŸºç¡€ä¿¡æ¯ -->
    <div class="input-grid">
        <div class="input-row">
            <label>ç©å®¶åç§°ï¼š</label>
            <input type="text" id="playerName" required>
        </div>
        <div class="input-row">
            <label>ç­‰çº§ï¼š</label>
            <input type="number" id="level" min="1" max="90" required>
        </div>
        <div class="input-row">
            <label>èŒä¸šï¼š</label>
            <select id="playerClass" onchange="toggleSpecialFields()">
                <option value="ç´ é—®">ç´ é—®</option>
                <option value="é“è¡£">é“è¡£</option>
                <option value="ç¢æ¢¦">ç¢æ¢¦</option>
                <option value="è¡€æ²³">è¡€æ²³</option>
                <option value="é¾™åŸ">é¾™åŸ</option>
                <option value="ä¹çµ">ä¹çµ</option>
                <option value="ç¥ç›¸">ç¥ç›¸</option>
                <option value="ç„æœº">ç„æœº</option>
                <option value="ç ´é“">ç ´é“</option>
                <option value="å¤©é—®">å¤©é—®</option>
                <option value="æ½®å…‰">æ½®å…‰</option>
            </select>
        </div>
    </div>

    <!-- æˆ˜æ–—æ•°æ® -->
    <div class="input-grid">
        <div class="input-row">
            <label>å‡»è´¥æ•°</label>
            <input type="number" id="kills" min="0" required>
        </div>
        <div class="input-row">
            <label>åŠ©æ”»æ•°</label>
            <input type="number" id="assists" min="0" required>
        </div>
        <div class="input-row">
            <label>æˆ˜å¤‡èµ„æº</label>
            <input type="number" id="resources" min="0" required>
        </div>
        <div class="input-row">
            <label>å¯¹ç©å®¶ä¼¤å®³</label>
            <input type="number" id="playerDamage" min="0" required>
        </div>
        <div class="input-row">
            <label>å¯¹å»ºç­‘ä¼¤å®³</label>
            <input type="number" id="buildingDamage" min="0" required>
        </div>
        <div class="input-row">
            <label>æ²»ç–—å€¼</label>
            <input type="number" id="heal" min="0">
        </div>
        <div class="input-row">
            <label>æ‰¿å—ä¼¤å®³</label>
            <input type="number" id="damageTaken" min="0" required>
        </div>
        <div class="input-row">
            <label>é‡ä¼¤æ¬¡æ•°</label>
            <input type="number" id="deaths" min="0" required>
        </div>
    </div>

    <!-- èŒä¸šç‰¹æ®Šå­—æ®µ -->
    <div class="input-grid special-fields">
        <div class="input-row" data-class="ç´ é—®">
            <label>åŒ–ç¾½æ¬¡æ•°</label>
            <input type="number" id="revive" min="0">
        </div>
        <div class="input-row" data-class="æ½®å…‰">
            <label>æ¸…æ³‰æ¬¡æ•°</label>
            <input type="number" id="spring" min="0">
        </div>
        <div class="input-row" data-class="ä¹çµ">
            <label>ç„šéª¨æ¬¡æ•°</label>
            <input type="number" id="boneBurn" min="0">
        </div>
        <div class="input-row">
            <label>æ‰€åœ¨å›¢é•¿</label>
            <input type="text" id="teamLeader" required>
        </div>
        <div class="input-row">
            <label>èŒä¸šç³»æ•°</label>
            <input type="number" id="classFactor" step="0.01" min="0.5" max="2.0" required>
        </div>
    </div>
<style>
/* è°ƒæ•´ .container çš„å¸ƒå±€ */
.container {
    display: grid;
    grid-template-columns: 300px 1fr; /* å·¦ä¾§å›ºå®šå®½åº¦ï¼Œå³ä¾§è‡ªé€‚åº” */
    gap: 20px;
    align-items: start; /* ç¡®ä¿å†…å®¹é¡¶å¯¹é½ */
}
</style>
<!-- æ–°å¢å³ä¾§è¡¨æ ¼ç»“æ„ -->
<div class="data-section">
    <table id="battleTable" style="background:white;color:black;border-collapse:collapse;width:100%">
        <thead>
            <tr style="border-bottom:2px solid #ddd">
                <th style="padding:12px;width:30px">âœ“</th>
                <th style="padding:12px">æ—¥æœŸ</th>
                <th style="padding:12px">å¯¹å±€åç§°</th>
                <th>ç©å®¶åç§°èŒä¸š</th>
                <th>å‡»è´¥æ•°</th>
                <th>åŠ©æ”»æ•°</th>
                <th>æˆ˜å¤‡èµ„æº</th>
                <th>å¯¹ç©å®¶ä¼¤å®³</th>
                <th>å¯¹å»ºç­‘ä¼¤å®³</th>
                <th>æ²»ç–—å€¼</th>
                <th>æ‰¿å—ä¼¤å®³</th>
                <th>é‡ä¼¤æ•°</th>
                <th>åŒ–ç¾½/æ¸…æ³‰æ¬¡æ•°</th>
                <th>æ‰€åœ¨å›¢é•¿</th>
            </tr>
        </thead>
        <tbody id="battleDataBody">
            <!-- æ•°æ®è¡Œç¤ºä¾‹ -->
            <tr style="border-bottom:1px solid #eee">
                <td><input type="checkbox"></td>
                <td>2023-08-15</td>
                <td>æ±´äº¬å†³æˆ˜</td>
                <td>å‰‘ä¾ æƒ…ç¼˜@ç´ é—®</td>
                <td>5</td>
                <td>12</td>
                <td>260</td>
                <td>36000</td>
                <td>80000</td>
                <td>15000</td>
                <td>80000</td>
                <td>7</td>
                <td>7</td>
                <td>è‰¯å“¥</td>
            </tr>
        </tbody>
    </table>
</div>

<!-- æŒ‰é’®åŒºæ”¹é€  -->
<div style="margin-top:20px;display:flex;gap:10px">
    <button onclick="submitData()" style="background:#4CAF50">ğŸ”„æäº¤</button>
    <button onclick="analyzeSelected()" style="background:#2196F3">ğŸ”åˆ†æé€‰ä¸­é¡¹</button>
</div>
<script>
// èŒä¸šç³»æ•°é»˜è®¤å€¼æ˜ å°„
const CLASS_FACTORS = {
    'ç´ é—®': 0.95,
    'é“è¡£': 1.0,
    'ç¢æ¢¦': 1.2,
    'è¡€æ²³': 0.95,
    'é¾™åŸ': 1.0,
    'ä¹çµ': 1.0,
    'ç¥ç›¸': 1.0,
    'ç„æœº': 1.0,
    'ç ´é“': 1.1,
    'å¤©é—®': 1.0,
    'æ½®å…‰': 0.95
};

// åŠ¨æ€æ˜¾ç¤ºèŒä¸šç‰¹æ®Šå­—æ®µ
function toggleSpecialFields() {
    const selectedClass = document.getElementById('playerClass').value;
    document.querySelectorAll('.special-fields [data-class]').forEach(field => {
        field.style.display = field.dataset.class === selectedClass ? 'flex' : 'none';
    });
    
    // è‡ªåŠ¨å¡«å……èŒä¸šç³»æ•°
    document.getElementById('classFactor').value = CLASS_FACTORS[selectedClass];
}

// æ•°æ®æ”¶é›†å¢å¼ºç‰ˆ
function collectInputData() {
    return {
        name: document.getElementById('playerName').value.trim(),
        level: parseInt(document.getElementById('level').value),
        class: document.getElementById('playerClass').value,
        kills: parseInt(document.getElementById('kills').value),
        assists: parseInt(document.getElementById('assists').value),
        resources: parseInt(document.getElementById('resources').value),
        playerDamage: parseInt(document.getElementById('playerDamage').value),
        buildingDamage: parseInt(document.getElementById('buildingDamage').value),
        heal: parseInt(document.getElementById('heal').value) || 0,
        damageTaken: parseInt(document.getElementById('damageTaken').value),
        deaths: parseInt(document.getElementById('deaths').value),
        revive: parseInt(document.getElementById('revive').value) || 0,
        spring: parseInt(document.getElementById('spring').value) || 0,
        boneBurn: parseInt(document.getElementById('boneBurn').value) || 0,
        teamLeader: document.getElementById('teamLeader').value.trim(),
        classFactor: parseFloat(document.getElementById('classFactor').value)
    };
}
    
     
// æ•°æ®å­˜å‚¨ç»“æ„æ”¹é€ 
let rawBattleData = [];

// ğŸ”„æäº¤æ•°æ®å¤„ç†
function submitData() {
    const formData = {
        date: document.getElementById('battleDate').value || new Date().toISOString().split('T')[0],
        battleName: document.getElementById('battleName').value.trim() || "æœªå‘½åå¯¹å±€",
        player: document.getElementById('playerName').value,
        class: document.getElementById('playerClass').value,
        // å…¶ä»–å­—æ®µæ”¶é›†...
        resources: parseInt(document.getElementById('resources').value) || 0,
        buildingDamage: parseInt(document.getElementById('buildingDamage').value) || 0
    };

    rawBattleData.push(formData);
    updateDataTable();
}

// ğŸ†•è¡¨æ ¼æ›´æ–°å‡½æ•°
function updateDataTable() {
    const tbody = document.getElementById('battleDataBody');
    tbody.innerHTML = rawBattleData.map((data,index) => `
        <tr>
            <td><input type="checkbox" id="check${index}"></td>
            <td>${data.date}</td>
            <td>${data.battleName}</td>
            <td>${data.player}@${data.class}</td>
            <td>${data.kills || 0}</td>
            <td>${data.assists || 0}</td>
            <td>${data.resources}</td>
            <td>${data.buildingDamage}</td>
            <td>${data.heal || 0}</td>
            <td>${data.damageTaken || 0}</td>
            <td>${data.deaths || 0}</td>
            <td>${data.deathLeader || '-'}</td>
            <td>${data.teamLeader || '-'}</td>
        </tr>
    `).join('');
}

// ğŸ†•åˆ†æé€‰ä¸­é¡¹åŠŸèƒ½
function analyzeSelected() {
    const selectedIndexes = [...document.querySelectorAll('input[type="checkbox"]')]
        .map((checkbox,index) => checkbox.checked ? index : -1)
        .filter(i => i >= 0);

    selectedIndexes.forEach(index => {
        const data = rawBattleData[index];
        const score = calculateScore(data); // è°ƒç”¨è®¡ç®—å…¬å¼
        alert(`[${data.battleName}] ${data.player} å¾—åˆ†ï¼š${score.toFixed(2)}`);
    });
}

// è®¡ç®—å…¬å¼å°è£…
function calculateScore(data) {
    // æ ¹æ®èŒä¸šè°ƒç”¨ä¸åŒå…¬å¼
    const formula = classFormulas[data.class];
    return formula ? formula(data) : 0;
}
</script>

<style>
/* å¢å¼ºæ ·å¼ */
.input-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
    gap: 12px;
    margin: 15px 0;
    padding: 10px;
    background: #fff;
    border-radius: 6px;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}

.input-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.special-fields [data-class] {
    display: none;
}

input[type="number"] {
    width: 100px;
}

select {
    width: 150px;
}
</style>

